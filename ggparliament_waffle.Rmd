---
title: "ggparliament_waffle"
author: "Zoe Meers"
date: "16/05/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(waffle)
library(tidyverse)
library(extrafont)
library(ggparliament)
```


```{r}
ukresults <- read_csv("UK2017.csv")
ukresults <- ukresults %>%
    filter(!is.na(win)) %>%
    group_by(win) %>%
    count(win) 
ukresults$n <- as.numeric(ukresults$n)
left_parties <- c("lab","snp","lib","grn","plc", "ind","oth")
ukresults$location <-
  ifelse(ukresults$win %in% left_parties, "left",
         ifelse(ukresults$win==c("con"), "right",
                ifelse(ukresults$win==c("dup"), "crossbench",
                        NA  )))
```

```{r}
ukresults_left <- ukresults %>%
  filter(location=="left")
left <- waffle(ukresults_left$n, rows=10, keep=FALSE) + scale_color_brewer(palette="Accent")
#left
ukresults_right <- ukresults %>%
  filter(location=="right")
right <- waffle(ukresults_right$n, rows=10, keep=FALSE, color=c("light blue", "white")) +  scale_color_brewer(palette="Accent")
iron(left,right)
a <- waffle(ukresults$n, rows=10, keep=FALSE, color=c("red", "green", "purple", "yellow","blue","brown","dark blue","sky blue", "orange","gray", "pink"))


a + facet_grid(location~.)


```

```{r}
ggplot_westminster <- function(dat = NA, rows = NULL, seatspp = NA, partyvar = NA) {
  westminster <- expand.grid(
    y = 1:rows,
    x = seq_len(ceiling(sum(seatspp) / rows)),
    z = partyvar
  )

  vec <- rep(partyvar, seatspp)
  westminster$party <- c(vec, rep(NA, nrow(westminster) - length(vec)))

  # Plot it
  ggplot(westminster, aes(x = x, y = y)) + geom_point(color = westminster$party) + coord_flip() + theme_void()
}

a <- ggplot_westminster(dat = ukresults_left, seatspp = ukresults_left$n, partyvar = ukresults_left$n, rows = 10)

b <- ggplot_westminster(dat = ukresults_right, seatspp = ukresults_right$n, partyvar = ukresults_right$n, rows = 10)

combine_westminster <- function(left=NA, right=NA) {
  left + plot_spacer() + right
}


combine_westminster(left = a, right = b)
```
```{r, fig.width=3}
ggplot(data=na.omit(ukresults), aes(x=location, y=n, group=win, fill=win)) + geom_bar(stat="identity") +  scale_x_discrete(limits=c("left", "crossbench","right")) + ussc::scale_fill_ussc(discrete=TRUE, reverse=TRUE)+ coord_flip() + theme_void()

ggplot(data=na.omit(ukresults), aes(x=location,  group=win, fill=win)) + geom_dotplot(stackgroups = TRUE, binpositions = "all", method="histodot") +  scale_x_discrete(limits=c("left", "crossbench","right")) + ussc::scale_fill_ussc(discrete=TRUE, reverse=TRUE)+ coord_flip() + theme_void()
```




```{r}

```

